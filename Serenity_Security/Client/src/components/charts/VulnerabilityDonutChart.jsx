import React from 'react';
import { PieChart, Pie, Cell, ResponsiveContainer } from 'recharts';

const VulnerabilityDonutChart = ({ data, total, width, height }) => {
  const filteredData = data.filter(item => item.value > 0);
  
  return (
    <div style={{ width, height, display: 'flex', flexDirection: 'column' }}>
      <div style={{ width: '100%', height: '70%', position: 'relative' }}>
        <ResponsiveContainer width="100%" height="100%">
          <PieChart margin={{ top: 10, right: 10, bottom: 10, left: 10 }}>
            <Pie
              data={filteredData.length > 0 ? filteredData : [{ name: 'No Issues', value: 1, color: '#e0e0e0' }]}
              cx="50%"
              cy="50%"
              innerRadius={40}
              outerRadius={60}
              paddingAngle={2}
              dataKey="value"
            >
              {(filteredData.length > 0 ? filteredData : [{ name: 'No Issues', value: 1, color: '#e0e0e0' }])
                .map((entry, index) => (
                  <Cell key={`cell-${index}`} fill={entry.color} />
              ))}
            </Pie>
          </PieChart>
        </ResponsiveContainer>
        
        {/* Total counter in the middle of the donut */}
        <div
          style={{
            position: 'absolute',
            top: '50%',
            left: '50%',
            transform: 'translate(-50%, -50%)',
            textAlign: 'center',
            pointerEvents: 'none'
          }}
        >
          <div style={{ fontSize: '16px', fontWeight: 'bold' }}>{total}</div>
          <div style={{ fontSize: '10px' }}>Issues</div>
        </div>
      </div>
      
      {/* Legend section - separately below the chart */}
      <div style={{ 
        width: '100%', 
        paddingTop: '5px',
        paddingLeft: '10px',
        display: 'flex',
        flexDirection: 'column'
      }}>
        {filteredData.map((entry, index) => (
          <div key={`legend-${index}`} style={{ 
            display: 'flex', 
            alignItems: 'center',
            marginBottom: '3px',
            fontSize: '10px'
          }}>
            <div style={{ 
              backgroundColor: entry.color, 
              width: '8px', 
              height: '8px', 
              marginRight: '4px',
              borderRadius: '50%'
            }}/>
            <span>{entry.value} {entry.name}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

export default VulnerabilityDonutChart;