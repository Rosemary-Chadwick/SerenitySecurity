import React from 'react';
import { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend } from 'recharts';

const VulnerabilityDonutChart = ({ data, total, width = 300, height = 300 }) => {
  // Use more muted colors that match our theme
  const mutedColors = [
    '#a83246', // Muted red for high
    '#d9b55a', // Muted yellow for medium
    '#5a9178'  // Muted green for low
  ];
  
  // Map our colors to the data
  const chartData = data.map((item, index) => ({
    ...item,
    color: mutedColors[index] || item.color
  }));
  
  return (
    <div style={{ width, height, position: 'relative' }}>
      <ResponsiveContainer width="100%" height="100%">
        <PieChart>
          <Pie
            data={chartData}
            cx="50%"
            cy="%"
            innerRadius={45}
            outerRadius={60}
            paddingAngle={2}
            dataKey="value"
          >
            {chartData.map((entry, index) => (
              <Cell key={`cell-${index}`} fill={entry.color} />
            ))}
          </Pie>
          <Tooltip
            formatter={(value, name) => [`${value}`, `${name} Severity`]}
            contentStyle={{ 
              backgroundColor: '#fdf6e3', 
              color: '#1b2a3c',
              borderRadius: '4px',
              borderColor: '#1b2a3c',
              zIndex: 1000 // Higher z-index to ensure it's on top
            }}
          />
          <Legend
            verticalAlign="bottom"
            height={25}
            iconType="circle"
            iconSize={8}
            formatter={(value) => (
              <span style={{ fontSize: '12px', color: 'inherit' }}>{value}</span>
            )}
          />
        </PieChart>
      </ResponsiveContainer>
      
      {/* Total counter in the middle */}
      <div
        style={{
          position: 'absolute',
          top: '40%',
          left: '50%',
          transform: 'translate(-50%, -50%)',
          textAlign: 'center',
          pointerEvents: 'none',
          zIndex: 1
        }}
      >
        <div style={{ fontSize: '24px', fontWeight: 'bold' }}>{total}</div>
        {/* <div style={{ fontSize: '12px' }}>vulnerabilities</div> */}
      </div>
    </div>
  );
};

export default VulnerabilityDonutChart;